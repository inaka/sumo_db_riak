%% -*- mode: erlang;erlang-indent-level: 2;indent-tabs-mode: nil -*-
%% ex: ts=4 sw=4 ft=erlang et
%% == Erlang Compiler ==

{
  erl_opts,
  [
    warn_unused_vars,
    warnings_as_errors,
    ewarn_export_all,
    warn_shadow_vars,
    warn_unused_import,
    warn_unused_function,
    warn_bif_clash,
    warn_unused_record,
    warn_deprecated_function,
    warn_obsolete_guard,
    strict_validation,
    warn_export_vars,
    warn_exported_vars,
    %warn_missing_spec,
    warn_untyped_record,
    debug_info
  ]
}.

%% == Dependencies ==

{
  deps,
  [
    {
      datetime,
      {git, "https://github.com/jagguli/date_util.git", {branch, "master"}}
    },
    {
      sumo_db,
      {git, "https://github.com/jagguli/sumo_db.git", {branch, "master"}}
    },
    {
      riakc,
      {
        git,
        "git://github.com/basho/riak-erlang-client.git",
        {branch, "develop-3.0"}
      }
    },
    {iso8601, "1.1.2", {pkg, inaka_iso8601}}
  ]
}.

%% == Overrides ==

{overrides, []}.

%% == Profiles ==

{
  profiles,
  [
    {
      test,
      [
        {
          deps,
          [katana_test, {mixer, "1.2.0", {pkg, inaka_mixer}}, {elvis, "1.0.1"}]
        }
      ]
    }
  ]
}.

%% == Common Test ==

{
  ct_compile_opts,
  [
    warn_unused_vars,
    warn_export_all,
    warn_shadow_vars,
    warn_unused_import,
    warn_unused_function,
    warn_bif_clash,
    warn_unused_record,
    warn_deprecated_function,
    warn_obsolete_guard,
    strict_validation,
    warn_export_vars,
    warn_exported_vars,
    warn_missing_spec,
    warn_untyped_record,
    debug_info
  ]
}.

{ct_opts, [{sys_config, ["test/test.config"]}]}.

%% == Cover ==

{cover_enabled, true}.

{cover_opts, [verbose]}.

%% == EDoc ==

{
  edoc_opts,
  [
    {report_missing_types, true},
    {source_path, ["src"]},
    {report_missing_types, true},
    {todo, true},
    {packages, false},
    {subpackages, false}
  ]
}.

%% == Dialyzer ==

{
  dialyzer,
  [
    {warnings, [race_conditions, no_return, unmatched_returns, error_handling]},
    {plt_apps, top_level_deps},
    {plt_extra_apps, []},
    {plt_location, local},
    {plt_prefix, "sumo_db_riak"},
    {base_plt_location, ".plt"},
    {base_plt_prefix, "sumo_db_riak"}
  ]
}.

%% == Shell ==

{shell, [{apps, [sumo_db_riak]}]}.

%% == Plugins ==

{plugins, [steamroller]}.

{
  steamroller,
  [
    {line_length, 80},
    {indent, 2},
    {inputs, ["rebar.config", "{src,test,include}/*.{[he]rl,app.src}"]}
  ]
}.
